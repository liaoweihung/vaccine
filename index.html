<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é†«é™¢è—¥å¸«å°ˆç”¨ - ç–«è‹—æ±ºç­–ç³»çµ± (V6)</title>
    
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="apple-mobile-web-app-title" content="ç–«è‹—æŸ¥è©¢">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <style>
        :root {
            --primary: #007bff; 
            --secondary: #6c757d;
            --success: #28a745; --success-bg: #e6fffa;
            --danger: #dc3545; --danger-bg: #fff5f5;
            --purple: #6f42c1; --purple-bg: #f3f0ff; 
            --pink: #d63384; --pink-bg: #fff0f6; 
            --light: #f8f9fa;
        }
        body { font-family: "Microsoft JhengHei", -apple-system, sans-serif; background: #f0f2f5; padding: 20px; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); overflow: hidden; }
        
        /* Header */
        .header { background: var(--primary); color: white; padding: 15px 20px; text-align: center; }
        .header h2 { margin: 0; font-size: 1.6rem; display: flex; align-items: center; justify-content: center; }
        .header p { margin: 8px 0 0; opacity: 0.9; font-size: 0.9rem; }

        .app-logo { width: 48px; height: 48px; border-radius: 50%; border: 2px solid white; margin-right: 12px; object-fit: cover; }
        
        /* Tabs */
        .tabs { display: flex; background: #e9ecef; }
        .tab-btn { flex: 1; padding: 15px; border: none; background: transparent; cursor: pointer; font-size: 1.1rem; font-weight: bold; color: var(--secondary); border-bottom: 4px solid transparent; transition: 0.2s; }
        .tab-btn.active { background: white; color: var(--primary); border-bottom-color: var(--primary); }

        .content-section { padding: 20px; display: none; }
        .content-section.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Form */
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: #495057; }
        input, select { width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem; box-sizing: border-box; }
        
        .checkbox-group { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 10px; }
        .checkbox-item { background: var(--light); padding: 10px; border-radius: 8px; display: flex; align-items: center; cursor: pointer; border: 1px solid #dee2e6; }
        .checkbox-item input { width: auto; margin-right: 10px; transform: scale(1.3); }
        /* ç•¶é¸ä¸­å­•å©¦æ™‚ï¼Œè©²é¸é …ç‰¹åˆ¥äº®èµ· */
        .checkbox-item.preg-checked { background: var(--pink-bg); border-color: var(--pink); color: var(--pink); font-weight: bold; }

        .btn-query { width: 100%; padding: 14px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-query:hover { background: #0056b3; transform: translateY(-1px); }

        .info-box { background: #e3f2fd; color: #0d47a1; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-weight: bold; text-align: center; border: 1px solid #bbdefb; }

        /* Results */
        .result-area { margin-top: 30px; border-top: 2px solid #eee; padding-top: 20px; }
        .vaccine-card { background: white; border: 1px solid #eee; border-radius: 8px; padding: 15px; margin-bottom: 12px; border-left: 6px solid var(--secondary); box-shadow: 0 2px 5px rgba(0,0,0,0.03); }
        
        /* ç‹€æ…‹é¡è‰² */
        .status-due { border-left-color: var(--danger); background: var(--danger-bg); }
        .status-self { border-left-color: var(--purple); background: var(--purple-bg); }
        .status-upcoming { border-left-color: var(--success); background: var(--success-bg); }
        .status-adult-rec { border-left-color: var(--primary); background: #f0f7ff; }
        
        /* å­•å©¦å°ˆç”¨ç‹€æ…‹ */
        .status-preg-ok { border-left-color: #e83e8c; background: #fff0f6; border: 2px solid #e83e8c; } /* æ¨è–¦æ‰“ */
        .status-preg-no { border-left-color: #6c757d; background: #f8f9fa; opacity: 0.8; } /* ä¸å»ºè­°æ‰“ */

        .v-title { display: flex; justify-content: space-between; align-items: center; font-size: 1.1rem; font-weight: bold; margin-bottom: 5px; }
        .badge { font-size: 0.8rem; padding: 4px 8px; border-radius: 12px; color: white; background: var(--secondary); margin-left: 5px; }
        
        .badge.public { background: var(--danger); }
        .badge.self { background: var(--purple); }
        .badge.hpv-public { background: var(--pink); }
        .badge.upcoming { background: var(--success); }
        .badge.adult { background: var(--primary); }
        .badge.season { background: #20c997; }
        .badge.preg { background: #e83e8c; } /* å­•å©¦æ¨™ç±¤ */
        .badge.warn { background: #dc3545; } /* è­¦å‘Šæ¨™ç±¤ */
        
        .v-desc { color: #555; font-size: 0.95rem; line-height: 1.5; }
        .highlight { color: #d63384; font-weight: bold; }
        .preg-note { display: block; margin-top: 6px; padding: 6px; background: rgba(255,255,255,0.8); border-radius: 4px; font-size: 0.9rem; font-weight: bold; color: #d63384; }
        .preg-warn { color: #dc3545; }
        
        .toggle-container { display: flex; align-items: center; justify-content: flex-end; margin-bottom: 10px; }
        .toggle-label { font-size: 0.9rem; margin-right: 10px; font-weight: bold; color: var(--purple); }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2><img src="icon.png" class="app-logo" alt="Logo"> ç–«è‹—è‡¨åºŠæ±ºç­–ç³»çµ± V6</h2>
        <p>æ•´åˆ å­•å©¦ç”¨è—¥å®‰å…¨ / çš®è›‡ / HPV / è‚ºç‚éˆçƒèŒ</p>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('child')">ğŸ‘¶ å…’ç«¥/é’å°‘å¹´</button>
        <button class="tab-btn" onclick="switchTab('adult')">ğŸ‘´ æˆäºº/é•·è€…/å­•å©¦</button>
    </div>

    <div id="tab-child" class="content-section active">
        <div class="form-group">
            <label>å…’ç«¥å‡ºç”Ÿå¹´æœˆæ—¥ï¼š</label>
            <input type="date" id="childBirthdate" onchange="updateChildAge()">
        </div>
        <div class="form-group">
            <label>æ€§åˆ¥ (å½±éŸ¿ HPV å…¬è²»åˆ¤æ–·)ï¼š</label>
            <select id="childGender" onchange="if(document.getElementById('childBirthdate').value) queryChildVaccines()">
                <option value="male">ç”·</option>
                <option value="female">å¥³</option>
            </select>
        </div>
        <div class="toggle-container">
            <span class="toggle-label">é¡¯ç¤ºè‡ªè²»é …ç›®</span>
            <input type="checkbox" id="showSelfPaid" checked onchange="if(document.getElementById('childBirthdate').value) queryChildVaccines()">
        </div>
        <div id="childAgeDisplay" class="info-box">è«‹è¼¸å…¥è³‡æ–™</div>
        <button class="btn-query" onclick="queryChildVaccines()">æŸ¥è©¢æ™‚ç¨‹</button>
        <div id="childResult" class="result-area"></div>
    </div>

    <div id="tab-adult" class="content-section">
        <div class="form-group">
            <label>å¹´é½¡ (æ­²)ï¼š</label>
            <input type="number" id="adultAge" placeholder="ä¾‹å¦‚ï¼š30">
        </div>

        <div class="form-group">
            <label>ç‰¹æ®Šèº«ä»½ / é¢¨éšªå› å­ï¼š</label>
            <div class="checkbox-group">
                <label class="checkbox-item" id="lbl-pregnant" onclick="highlightPreg()"><input type="checkbox" id="pregnant"> å­•å©¦</label>
                <label class="checkbox-item"><input type="checkbox" id="highRisk"> é«˜é¢¨éšª/å…ç–«ä½ä¸‹ (å«æ´—è…/ç™Œç—‡)</label>
                <label class="checkbox-item"><input type="checkbox" id="medicalStaff"> é†«äº‹äººå“¡</label>
            </div>
        </div>

        <div class="form-group" style="background: #fff8e1; padding: 15px; border-radius: 8px; border: 1px solid #ffeeba;">
            <label style="color: #856404;">ğŸ’‰ è‚ºç‚éˆçƒèŒæ¥ç¨®å² (65æ­²+æˆ–é«˜é¢¨éšª)ï¼š</label>
            <select id="pneumoHistory">
                <option value="none">å®Œå…¨æœªæ›¾æ¥ç¨®</option>
                <option value="ppv23">æ›¾æ¥ç¨®é 23åƒ¹ (PPV23)</option>
                <option value="pcv13">æ›¾æ¥ç¨®é 13åƒ¹/15åƒ¹ (PCV13/15)</option>
                <option value="both">å·²å®Œæˆ PCV + PPV æ¥åŠ›</option>
            </select>
        </div>

        <button class="btn-query" onclick="queryAdultVaccines()">æŸ¥è©¢æˆäººå»ºè­°</button>
        <div id="adultResult" class="result-area"></div>
    </div>
</div>

<script>
    // ================= è¼”åŠ©åŠŸèƒ½ =================
    function switchTab(tab) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        if (tab === 'child') {
            document.querySelector('.tab-btn:nth-child(1)').classList.add('active');
            document.getElementById('tab-child').classList.add('active');
        } else {
            document.querySelector('.tab-btn:nth-child(2)').classList.add('active');
            document.getElementById('tab-adult').classList.add('active');
        }
    }
    
    function highlightPreg() {
        const chk = document.getElementById('pregnant');
        const lbl = document.getElementById('lbl-pregnant');
        // ç¨å¾®å»¶é²ä»¥ç²å–é»æ“Šå¾Œçš„ç‹€æ…‹
        setTimeout(() => {
            if(chk.checked) lbl.classList.add('preg-checked');
            else lbl.classList.remove('preg-checked');
        }, 50);
    }

    // ================= å…’ç«¥é‚è¼¯ (V6ç‰ˆ) =================
    const childSchedule = [
        { name: "Bå‹è‚ç‚ (HepB-2)", month: 1, range: [1, 2], type: 'public', desc: "å…¬è²»ã€‚æ»¿1å€‹æœˆæ¥ç¨®ã€‚" },
        { name: "äº”åˆä¸€ + PCV13 (ç¬¬1åŠ‘)", month: 2, range: [2, 3], type: 'public', desc: "å…¬è²»ã€‚æ»¿2å€‹æœˆæ¥ç¨®ã€‚" },
        { name: "äº”åˆä¸€ + PCV13 (ç¬¬2åŠ‘)", month: 4, range: [4, 5], type: 'public', desc: "å…¬è²»ã€‚æ»¿4å€‹æœˆæ¥ç¨®ã€‚" },
        { name: "å¡ä»‹è‹— (BCG)", month: 5, range: [5, 12], type: 'public', desc: "å…¬è²»ã€‚å»ºè­°5-8å€‹æœˆå®Œæˆã€‚" },
        { name: "äº”åˆä¸€ + Bè‚ (ç¬¬3åŠ‘)", month: 6, range: [6, 12], type: 'public', desc: "å…¬è²»ã€‚æ»¿6å€‹æœˆæ¥ç¨®ã€‚" },
        { name: "æµæ„Ÿç–«è‹— (åˆæ¬¡)", month: 6, range: [6, 999], type: 'public', desc: "å…¬è²»ã€‚æ»¿6å€‹æœˆä»¥ä¸Šï¼Œåˆæ¬¡éœ€æ‰“2åŠ‘ã€‚" },
        { name: "æ°´ç—˜ + MMR + PCV13 (æ»¿æ­²)", month: 12, range: [12, 18], type: 'public', desc: "å…¬è²»ã€‚æ»¿1æ­²æ¥ç¨®ã€‚" },
        { name: "Aå‹è‚ç‚ (ç¬¬1åŠ‘)", month: 12, range: [12, 60], type: 'public', desc: "å…¬è²»ã€‚æ»¿1æ­²æ¥ç¨®ã€‚" },
        { name: "æ—¥æœ¬è…¦ç‚ (ç¬¬1åŠ‘)", month: 15, range: [15, 24], type: 'public', desc: "å…¬è²»ã€‚æ»¿15å€‹æœˆæ¥ç¨®ã€‚" },
        { name: "äº”åˆä¸€ (ç¬¬4åŠ‘)", month: 18, range: [18, 30], type: 'public', desc: "å…¬è²»ã€‚æ»¿1æ­²åŠæ¥ç¨®ã€‚" },
        { name: "Aå‹è‚ç‚ (ç¬¬2åŠ‘)", month: 18, range: [18, 120], type: 'public', desc: "å…¬è²»ã€‚éœ€èˆ‡ç¬¬ä¸€åŠ‘é–“éš”6å€‹æœˆã€‚" },
        { name: "æ—¥æœ¬è…¦ç‚ (ç¬¬2åŠ‘)", month: 27, range: [27, 48], type: 'public', desc: "å…¬è²»ã€‚æ»¿2æ­²3å€‹æœˆæ¥ç¨®ã€‚" },
        { name: "å…¥å­¸å‰å››åˆä¸€+MMR+JE", month: 60, range: [60, 84], type: 'public', desc: "å…¬è²»ã€‚æ»¿5æ­²è‡³å…¥å°å­¸å‰ã€‚" },
        { name: "è¼ªç‹€ç—…æ¯’", month: 2, range: [1.5, 8], type: 'self', desc: "ğŸ’¡å»ºè­°è‡ªè²»ã€‚å‡ºç”Ÿ15é€±å…§é–‹å§‹ï¼Œ8å€‹æœˆå…§å®Œæˆã€‚" },
        { name: "è…¸ç—…æ¯’ 71 å‹", month: 2, range: [2, 72], type: 'self', desc: "ğŸ’¡å»ºè­°è‡ªè²»ã€‚æ»¿2å€‹æœˆè‡³6æ­²é©ç”¨ã€‚" },
        { name: "Bå‹è…¦è†œç‚é›™çƒèŒ", month: 2, range: [2, 600], type: 'self', desc: "å»ºè­°è‡ªè²»ã€‚æ»¿2å€‹æœˆä»¥ä¸Šå³å¯ã€‚" },
        { name: "HPV 9åƒ¹ç–«è‹— (å…¬è²»)", month: 132, range: [132, 180], type: 'hpv-public', gender: 'female', desc: "ğŸ’– å…¬è²»å°ˆæ¡ˆï¼šåœ‹ä¸­å…¥å­¸å¥³ç”Ÿ(ç´„11-13æ­²)ã€‚" },
        { name: "HPV 9åƒ¹ç–«è‹— (è‡ªè²»)", month: 108, range: [108, 540], type: 'self', desc: "ğŸ’¡å»ºè­°è‡ªè²»ã€‚9-45æ­²ç”·å¥³çš†é©ç”¨ã€‚" }
    ];

    let currentChildMonths = 0;
    function updateChildAge() {
        const input = document.getElementById('childBirthdate').value;
        if (!input) return;
        const dob = new Date(input);
        const today = new Date();
        let years = today.getFullYear() - dob.getFullYear();
        let months = today.getMonth() - dob.getMonth();
        if (months < 0) { years--; months += 12; }
        currentChildMonths = (years * 12) + months;
        document.getElementById('childAgeDisplay').innerHTML = `ç›®å‰å¹´é½¡ï¼š${years}æ­²${months}å€‹æœˆ (ç¸½æœˆé½¡: ${currentChildMonths}m)`;
    }

    function queryChildVaccines() {
        if (!document.getElementById('childBirthdate').value) { alert("è«‹è¼¸å…¥å‡ºç”Ÿæ—¥æœŸ"); return; }
        const showSelf = document.getElementById('showSelfPaid').checked;
        const gender = document.getElementById('childGender').value;
        const resDiv = document.getElementById('childResult');
        let html = "";
        let due = [], upcoming = [];

        childSchedule.forEach(v => {
            if (v.type === 'self' && !showSelf) return; 
            if (v.name.includes("è¼ªç‹€") && currentChildMonths > 8) return;
            if (v.type === 'hpv-public' && gender !== 'female') return; 
            if (v.name.includes("HPV") && v.type === 'self' && gender === 'female' && currentChildMonths >= 132 && currentChildMonths <= 180) return;

            if (currentChildMonths >= v.month) {
                if ((currentChildMonths - v.month < 24) || v.month >= 60 || (v.type==='self' && currentChildMonths < v.range[1]) || v.type === 'hpv-public') {
                    if (currentChildMonths <= v.range[1]) due.push(v);
                }
            } else if (v.month > currentChildMonths && v.month <= currentChildMonths + 12) {
                upcoming.push(v);
            }
        });
        due.sort((a,b) => a.month - b.month);

        if (due.length > 0) {
            html += `<h3>ğŸš¨ æœ¬æ¬¡å°±é†«å»ºè­°</h3>`;
            due.forEach(v => {
                let badgeClass = 'public'; let cardClass = 'status-due'; let badgeText = 'å…¬è²»æ‡‰æ‰“';
                if (v.type === 'self') { badgeClass = 'self'; cardClass = 'status-self'; badgeText = 'è‡ªè²»å»ºè­°'; } 
                else if (v.type === 'hpv-public') { badgeClass = 'hpv-public'; cardClass = 'status-hpv'; badgeText = 'å…¬è²»(å°ˆæ¡ˆ)'; }
                html += renderCard(v.name, v.desc, badgeText, badgeClass, cardClass);
            });
        } else {
            html += `<div style="text-align:center; padding:20px; color:#28a745;">âœ… ç›®å‰ç„¡å»ºè­°é …ç›®</div>`;
        }
        resDiv.innerHTML = html;
    }

    // ================= æˆäººé‚è¼¯ (V6 å­•å©¦åŠ å¼·ç‰ˆ) =================
    function queryAdultVaccines() {
        const age = parseInt(document.getElementById('adultAge').value);
        if (isNaN(age)) { alert("è«‹è¼¸å…¥å¹´é½¡"); return; }
        const isPreg = document.getElementById('pregnant').checked; // æª¢æŸ¥æ˜¯å¦ç‚ºå­•å©¦
        const isHighRisk = document.getElementById('highRisk').checked;
        const isMed = document.getElementById('medicalStaff').checked;
        const history = document.getElementById('pneumoHistory').value;
        let list = [];

        // 1. æµæ„Ÿèˆ‡ COVID-19 (å­•å©¦å®‰å…¨)
        list.push({ 
            name: "æµæ„Ÿç–«è‹— (Influenza)", 
            desc: "å»ºè­°æ¯å¹´10æœˆå¾Œæ¥ç¨®ã€‚", 
            tag: "å­£ç¯€æ€§",
            pregAdvice: "safe", // safe, caution, avoid
            pregNote: "ğŸ¤° <strong>å­•å©¦å¼·çƒˆå»ºè­°æ¥ç¨®</strong> (ä»»ä½•å­•æœŸçš†å¯)ã€‚å¯ä¿è­·åª½åª½èˆ‡èƒå…’ã€‚"
        });
        list.push({ 
            name: "COVID-19 ç–«è‹— (JN.1)", 
            desc: "å»ºè­°æ¥ç¨®æœ€æ–°è®Šç•°æ ªã€‚", 
            tag: "å­£ç¯€æ€§",
            pregAdvice: "safe",
            pregNote: "ğŸ¤° <strong>å­•å©¦å»ºè­°æ¥ç¨®</strong>ã€‚mRNA ç–«è‹—å°å­•å©¦æ˜¯å®‰å…¨çš„ã€‚"
        });

        // 2. Tdap (å­•å©¦æ ¸å¿ƒ)
        if (isPreg) {
            list.push({ 
                name: "Tdap (ç ´å‚·é¢¨/ç™¾æ—¥å’³)", 
                desc: "é é˜²æ–°ç”Ÿå…’ç™¾æ—¥å’³ã€‚", 
                tag: "å­•å©¦å°ˆç”¨",
                pregAdvice: "safe",
                pregNote: "ğŸ¤° <strong>å¼·çƒˆå»ºè­°</strong>ã€‚è«‹æ–¼æ‡·å­• 28-36 é€±æ¥ç¨®ï¼Œæ¯èƒçš†éœ€æ¥ç¨®ä¸€åŠ‘ã€‚"
            });
        } else if (isMed) {
            // å¦‚æœä¸æ˜¯å­•å©¦ä½†é†«è­·ï¼Œæ‰é¡¯ç¤ºé€™å€‹
            list.push({ name: "Tdap (ç ´å‚·é¢¨/ç™¾æ—¥å’³)", desc: "æ¯10å¹´å»ºè­°è¿½åŠ ä¸€åŠ‘ã€‚", tag: "é†«äº‹äººå“¡" });
        }

        // 3. å¸¶ç‹€ç–±ç–¹ (å­•å©¦éœ€è©•ä¼°)
        if (age >= 50 || (age >= 18 && isHighRisk)) {
            list.push({ 
                name: "å¸¶ç‹€ç–±ç–¹ç–«è‹— (Shingrix)", 
                desc: "å¼·çƒˆå»ºè­°(è‡ªè²»)ã€‚éæ´»æ€§é‡çµ„ç–«è‹—ï¼Œä¿è­·åŠ›>90%ã€‚", 
                tag: "è‡ªè²»",
                pregAdvice: "avoid",
                pregNote: "âš ï¸ <strong>è³‡æ–™ä¸è¶³ï¼Œå»ºè­°æš«ç·©</strong>ã€‚é€šå¸¸å»ºè­°ç”¢å¾Œå†æ–½æ‰“ã€‚"
            });
        }

        // 4. HPV (å­•å©¦ç¦å¿Œ)
        if (age >= 18 && age <= 45) {
            list.push({ 
                name: "HPV 9åƒ¹ç–«è‹—", 
                desc: "é é˜²èœèŠ±/å­å®®é ¸ç™Œã€‚", 
                tag: "è‡ªè²»",
                pregAdvice: "avoid",
                pregNote: "âŒ <strong>å­•å©¦ä¸å»ºè­°æ–½æ‰“</strong>ã€‚è‹¥æ¥ç¨®æœŸé–“ç™¼ç¾æ‡·å­•ï¼Œè«‹æš«ç·©å¾ŒçºŒåŠ‘æ¬¡è‡³ç”¢å¾Œã€‚"
            });
        }

        // 5. è‚ºç‚éˆçƒèŒ (å­•å©¦è©•ä¼°)
        if (age >= 65 || (age >= 19 && isHighRisk)) {
            let advice = "";
            let eligible = false;
            if (history === 'none') { advice = "å»ºè­°æ¥ç¨® 1 åŠ‘ PCV20/21ã€‚"; eligible = true; }
            else if (history === 'ppv23') { advice = "æ›¾æ‰“PPV23ï¼šé–“éš”1å¹´ï¼Œæ¥ç¨® PCV20/21ã€‚"; eligible = true; }
            else if (history === 'pcv13') { advice = "æ›¾æ‰“PCV13ï¼šé–“éš”1å¹´ï¼Œæ¥ç¨® PCV20/21ã€‚"; eligible = true; }
            
            if (eligible) {
                list.push({ 
                    name: "è‚ºç‚éˆçƒèŒ (PCV20/21)", 
                    desc: `å…¬è²»è³‡æ ¼(æ–°åˆ¶)ï¼š${advice}`, 
                    tag: "å…¬è²»å»ºè­°",
                    pregAdvice: "caution",
                    pregNote: "âš ï¸ <strong>éœ€è©•ä¼°æ•ˆç›Š</strong>ã€‚è‹¥ç„¡é«˜é¢¨éšªå› å­ï¼Œé€šå¸¸å»ºè­°ç”¢å¾Œå†æ¥ç¨®ã€‚"
                });
            }
        }

        // 6. é†«äº‹äººå“¡æ´»é«”ç–«è‹— (å­•å©¦ç¦å¿Œ)
        if (isMed) {
             // åªæœ‰ç•¶é†«äº‹äººå“¡å‹¾é¸æ™‚æ‰åˆ¤æ–·
             list.push({ 
                name: "MMR (éº»ç–¹è…®è…ºç‚å¾·åœ‹éº»ç–¹)", 
                desc: "é†«äº‹äººå“¡æ‡‰ç¢ºèªæŠ—é«”ã€‚", 
                tag: "é†«äº‹äººå“¡",
                pregAdvice: "avoid",
                pregNote: "âŒ <strong>çµ•å°ç¦å¿Œ (æ´»é«”ç–«è‹—)</strong>ã€‚æ¥ç¨®å¾Œ4é€±å…§æ‡‰é¿å…æ‡·å­•ã€‚"
            });
        }

        // æ¸²æŸ“çµæœ
        const resDiv = document.getElementById('adultResult');
        let html = "<h3>ğŸ” æŸ¥è©¢çµæœ</h3>";
        
        list.forEach(v => {
            // é è¨­æ¨£å¼
            let cardClass = v.tag === 'è‡ªè²»' ? 'status-self' : 'status-adult-rec';
            let badgeClass = v.tag === 'è‡ªè²»' ? 'self' : (v.tag === 'å­£ç¯€æ€§' ? 'season' : 'adult');
            if(v.tag === 'å…¬è²»å»ºè­°') badgeClass = 'adult';
            if(v.tag === 'å­•å©¦å°ˆç”¨') { badgeClass = 'preg'; cardClass = 'status-preg-ok'; }

            let noteHtml = "";

            // è‹¥å‹¾é¸å­•å©¦ï¼Œä»‹å…¥æ¨£å¼åˆ¤æ–·
            if (isPreg) {
                if (v.pregAdvice === 'safe') {
                    cardClass = 'status-preg-ok';
                    noteHtml = `<span class="preg-note">${v.pregNote}</span>`;
                } else if (v.pregAdvice === 'avoid') {
                    cardClass = 'status-preg-no';
                    noteHtml = `<span class="preg-note preg-warn">${v.pregNote}</span>`;
                } else if (v.pregAdvice === 'caution') {
                    noteHtml = `<span class="preg-note" style="color:#856404">${v.pregNote}</span>`;
                }
            } else {
                // å¦‚æœæ²’å‹¾é¸å­•å©¦ï¼Œå°±æŠŠä¸è©²å‡ºç¾çš„å­•å©¦ç¦å¿Œé¸é …éš±è— (ä¾‹å¦‚å–®ç´”é¡¯ç¤ºMMRç¦å¿Œæ²’æ„ç¾©)
                // é€™è£¡æˆ‘å€‘ä¿ç•™é¡¯ç¤ºï¼Œä½†éš±è— pregNote
            }

            html += renderCard(v.name, v.desc, v.tag, badgeClass, cardClass, noteHtml);
        });
        resDiv.innerHTML = html;
    }

    function renderCard(title, desc, badgeText, badgeClass, cardClass, extraNote = "") {
        return `
            <div class="vaccine-card ${cardClass}">
                <div class="v-title">
                    ${title}
                    <span class="badge ${badgeClass}">${badgeText}</span>
                </div>
                <div class="v-desc">
                    ${desc}
                    ${extraNote}
                </div>
            </div>
        `;
    }
</script>

</body>
</html>
